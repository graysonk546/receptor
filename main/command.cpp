
/*******************************************************************************
*                               Standard Libraries
*******************************************************************************/

#include <pt.h>
#include <Arduino.h>
#include <HardwareSerial.h>

/*******************************************************************************
*                               Header Files
*******************************************************************************/

#include "command.h"

/*******************************************************************************
*                               Static Functions
*******************************************************************************/

/*******************************************************************************
*                               Constants
*******************************************************************************/

#define SERIAL_TIMEOUT_MS 5000

/*******************************************************************************
*                               Structures
*******************************************************************************/

/*******************************************************************************
*                               Variables
*******************************************************************************/

static struct pt commandThread;

/*******************************************************************************
*                               Implementations
*******************************************************************************/

receptor_status_t command_init()
{
    // Begin the serial connection
    Serial.begin(9600);
    long time;
    while(!Serial)
    {
        if (millis() > SERIAL_TIMEOUT_MS)
        {
            return RECEPTOR_ERR;
        }
    }
    Serial.println("Initialized serial port!");

    // Initialize pt structure
    PT_INIT(&commandThread);
}

struct pt* command_getThread()
{
    return &commandThread;
}

command_status_t command_help(uint8_t argNumber, char* args[])
{
    Serial.println("Command successful!");
    return COMMAND_OK;
}
